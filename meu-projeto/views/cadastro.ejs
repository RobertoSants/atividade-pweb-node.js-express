<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title><%= title %></title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    .field { margin-bottom: 1rem; }
    .error { color: #b00020; font-size: .9em; margin-top: .3rem; }
  </style>
</head>
<body>
  <h1><%= title %></h1>
  <form method="post" action="/cadastro" novalidate>
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">

    <!-- Nome -->
    <div class="field">
      <label for="nome">Nome*</label>
      <input type="text" id="nome" name="nome" required minlength="3" maxlength="60"
             value="<%= data.nome || '' %>">
      <% if (errors.nome) { %><div class="error"><%= errors.nome.msg %></div><% } %>
    </div>

    <!-- E-mail -->
    <div class="field">
      <label for="email">E-mail*</label>
      <input type="email" id="email" name="email" required
             value="<%= data.email || '' %>">
      <% if (errors.email) { %><div class="error"><%= errors.email.msg %></div><% } %>
    </div>

    <!-- Senha -->
    <div class="field">
      <label for="senha">Senha*</label>
      <input type="password" id="senha" name="senha" required minlength="8" maxlength="20">
      <% if (errors.senha) { %><div class="error"><%= errors.senha.msg %></div><% } %>
    </div>

    <!-- País (select com optgroup) -->
    <div class="field">
      <label for="pais">País*</label>
      <select id="pais" name="pais" required>
        <option value="">Selecione...</option>
        <optgroup label="América do Sul">
          <option value="brasil" <%= data.pais === 'brasil' ? 'selected' : '' %>>Brasil</option>
          <option value="argentina" <%= data.pais === 'argentina' ? 'selected' : '' %>>Argentina</option>
        </optgroup>
        <optgroup label="América do Norte">
          <option value="eua" <%= data.pais === 'eua' ? 'selected' : '' %>>EUA</option>
          <option value="canada" <%= data.pais === 'canada' ? 'selected' : '' %>>Canadá</option>
        </optgroup>
      </select>
      <% if (errors.pais) { %><div class="error"><%= errors.pais.msg %></div><% } %>
    </div>

    <!-- Estado com datalist -->
    <div class="field">
      <label for="estado">Estado*</label>
      <input list="lista-estados" id="estado" name="estado" required value="<%= data.estado || '' %>">
      <datalist id="lista-estados">
        <option value="Alagoas">
        <option value="São Paulo">
        <option value="Rio de Janeiro">
        <option value="Pernambuco">
      </datalist>
      <% if (errors.estado) { %><div class="error"><%= errors.estado.msg %></div><% } %>
    </div>

    <!-- Gênero (radio buttons) -->
    <fieldset class="field">
      <legend>Gênero*</legend>
      <label><input type="radio" name="genero" value="masculino" <%= data.genero === 'masculino' ? 'checked' : '' %>> Masculino</label>
      <label><input type="radio" name="genero" value="feminino" <%= data.genero === 'feminino' ? 'checked' : '' %>> Feminino</label>
      <label><input type="radio" name="genero" value="outro" <%= data.genero === 'outro' ? 'checked' : '' %>> Outro</label>
      <% if (errors.genero) { %><div class="error"><%= errors.genero.msg %></div><% } %>
    </fieldset>

    <!-- Interesses (checkboxes) -->
    <fieldset class="field">
      <legend>Interesses</legend>
      <% const all = ['tecnologia', 'design', 'musica', 'esportes', 'cinema']; %>
      <% all.forEach(opt => { %>
        <label>
          <input type="checkbox" name="interesses" value="<%= opt %>"
            <%= (Array.isArray(data.interesses) && data.interesses.includes(opt)) ? 'checked' : '' %>>
          <%= opt.charAt(0).toUpperCase() + opt.slice(1) %>
        </label><br>
      <% }) %>
      <% if (errors.interesses) { %><div class="error"><%= errors.interesses.msg %></div><% } %>
    </fieldset>

    <!-- Comentário -->
    <div class="field">
      <label for="comentario">Comentário*</label>
      <textarea id="comentario" name="comentario" rows="4" minlength="10" maxlength="300"><%= data.comentario || '' %></textarea>
      <% if (errors.comentario) { %><div class="error"><%= errors.comentario.msg %></div><% } %>
    </div>

    <!-- Termos -->
    <div class="field">
      <label>
        <input type="checkbox" name="aceite" <%= data.aceite ? 'checked' : '' %>> Aceito os termos de uso*
      </label>
      <% if (errors.aceite) { %><div class="error"><%= errors.aceite.msg %></div><% } %>
    </div>

    <button type="submit">Cadastrar</button>
  </form>
</body>
</html>